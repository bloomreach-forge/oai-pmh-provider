<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2017-09-05
 | Rendered using Hippo Forge Maven Skin 1.04.00 based on Apache Maven Fluido Skin
-->
<!--[if lt IE 7]><html id="ie6" xmlns="http://www.w3.org/1999/xhtml"  xml:lang="en" lang="en"><![endif]-->
<!--[if IE 7]><html id="ie7" xmlns="http://www.w3.org/1999/xhtml"  xml:lang="en" lang="en"><![endif]-->
<!--[if IE 8]><html id="ie8" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><![endif]-->
<!--[if IE 9]><html id="ie9" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><![endif]-->
<!--[if !IE]>--><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><!--<![endif]-->

<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
                    <meta name="Date-Revision-yyyymmdd" content="20170905"/>
                <meta http-equiv="Content-Language" content="en"/>
        <title>Hippo OAI-PMH provider - 
    Usage Instructions</title>
    <link rel="stylesheet" href="./css/forge-maven-skin-syntaxhighlighter-1.04.00.min.css"/>
    <link rel="stylesheet" href="./css/forge-maven-skin-1.04.00.min.css"/>
    <link rel="stylesheet" href="./css/site.css"/>
    <link rel="stylesheet" href="./css/print.css" media="print"/>

        
    <script type="text/javascript" src="./js/forge-maven-skin-syntaxhighlighter-1.04.00.min.js"></script>
    <script type="text/javascript" src="./js/forge-maven-skin-1.04.00.min.js"></script>

    
            </head>
    <body>

        
    
    
    <div class="container-fluid">
        <div class="row-fluid">
            <div id="header">
                <div id="logo">
                    <a href="http://www.bloomreach.com">
                        <img src="./images/hipposkin/hippo-logo.png" alt="Hippo Logo" />
                    </a>
                </div>

                <h1>
                                            Hippo OAI-PMH provider
                    
                </h1>
                <div class="clearfix"></div>
            </div>
        </div>

        <div class="row-fluid">
            <div id="breadcrumbs" class="clearfix">
                <ul class="breadcrumb">
                                
                                        
                            <li id="publishDate">Last Published: 2018-09-28</li>
                                                                                                                                                </ul>

                <div class="links">
                    <a href="https://www.bloomreach.com">bloomreach.com</a>
                    <a href="https://www.onehippo.org">Onehippo.org</a>
                </div>
            </div>
        </div>



            
    <div class="row-fluid">
        <div id="leftColumn" class="span3">
            <div class="well sidebar-nav">
                <ul class="nav nav-list">
                                        <li class="nav-header">Hippo OAI-PMH provider</li>
                                                           
        <li>
    
                                                <a href="index.html" title="Introduction">
                    <i class="none"></i>
                Introduction</a>
                    </li>
                               
        <li class="active">
    
                        <a href="#"><i class="none"></i>Usage</a>
                </li>
                                                            <li class="nav-header">Autogenerated Docs</li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
        <li>
    
                                                <a href="project-info.html" title="Project Information">
                    <i class="icon-chevron-right"></i>
                Project Information</a>
                                </li>
                        </ul>

                
                <hr class="divider"/>

                <div id="poweredBy">
                                            <div class="clear"></div>
                                            <div class="clear"></div>
                                            <div class="clear"></div>
                                                <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
            <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png"/>
        </a>
                            </div>
            </div>
        </div>
    
        
        <div id="bodyColumn"  class="span9" >
                                
            <!-- Copyright 2009-2018 Hippo
    
    Licensed under the Apache License, Version 2.0 (the  "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at
    
    http://www.apache.org/licenses/LICENSE-2.0
    
    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS"
    BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License. -->
  
    <div class="section">
<h2>Usage<a name="Usage"></a></h2>
      
<div class="section">
<h3>Prerequisites<a name="Prerequisites"></a></h3>
        
<p>
          These instructions assume that you have a Hippo project based on the Hippo project archetype, i.e.
          a Maven multiproject consisting of three submodules: cms, site and content/bootstrap.
        </p>
        
<p>
          You should know on how to use the
          <a class="externalLink" href="http://www.onehippo.org/7_7/library/concepts/rest/restful-jax-rs-component-support-in-hst-2.html">HST jax-rs API</a>
        </p>
        
<p>
          You should know how the OAI-PMH protocol works; see the
          <a class="externalLink" href="http://www.openarchives.org/OAI/openarchivesprotocol.html">Protocol for Metadata Harvesting specification</a>
        </p>
      </div>

      
<div class="section">
<h3>Installation<a name="Installation"></a></h3>
        
<ol style="list-style-type: decimal">
          
<li>
            
<p>In the main pom.xml of the project, in the repositories section, add this repository if it is not configured there yet.</p>
            
<div class="source"><pre class="prettyprint linenums">
              
    &lt;repository&gt;
      &lt;id&gt;hippo-forge&lt;/id&gt;
      &lt;name&gt;Hippo Forge maven 2 repository.&lt;/name&gt;
      &lt;url&gt;https://maven.bloomreach.com/maven2-forge/&lt;/url&gt;
      &lt;snapshots&gt;
        &lt;enabled&gt;false&lt;/enabled&gt;
      &lt;/snapshots&gt;
      &lt;releases&gt;
        &lt;updatePolicy&gt;never&lt;/updatePolicy&gt;
      &lt;/releases&gt;
      &lt;layout&gt;default&lt;/layout&gt;
    &lt;/repository&gt;
            </pre></div>
          </li>

          
<li>
            
<p>Add to the pom.xml of your
              <i>cms</i>
              module:
            </p>
            
<div class="source"><pre class="prettyprint linenums">
              
&lt;dependency&gt;
 &lt;groupId&gt;org.onehippo.forge&lt;/groupId&gt;
 &lt;artifactId&gt;oai-pmh-provider-repository&lt;/artifactId&gt;
 &lt;version&gt;2.01.06&lt;/version&gt;
&lt;/dependency&gt;
                        
            </pre></div>
          </li>
          
<li>
            
<p>Add to the pom.xml of your
              <i>site</i>
              module:
            </p>
            
<div class="source"><pre class="prettyprint linenums">
              
&lt;dependency&gt;
 &lt;groupId&gt;org.onehippo.forge&lt;/groupId&gt;
 &lt;artifactId&gt;oai-pmh-provider-hst&lt;/artifactId&gt;
 &lt;version&gt;2.01.06&lt;/version&gt;
&lt;/dependency&gt;
                        
            </pre></div>
          </li>
          
<li>
            
<p>Add to the web.xml of your
              <i>site</i>
              module:
            </p>
            
<div class="source"><pre class="prettyprint linenums">
              
&lt;context-param&gt;
    &lt;param-name&gt;hst-beans-annotated-classes&lt;/param-name&gt;
    &lt;param-value&gt;.....,
      classpath*:org/onehippo/forge/oaipmh/provider/api/**/*.class,
    &lt;/param-value&gt;
  &lt;/context-param&gt;
                        
            </pre></div>
          </li>

        </ol>
      </div>

      
<div class="section">
<h3>Configure your content beans<a name="Configure_your_content_beans"></a></h3>
        
<p>first implement the org.onehippo.forge.oaipmh.provider.api.OAIBean</p>
        
<p>There are 3 types of annotations you should use in your content beans:</p>
        
<ol style="list-style-type: decimal">
          
<li>@OAI: for setting the setName (on the bean class)</li>
          
<li>@OAIDelegate: for delegating different metadata prefixes (we currently only support &quot;dc_oai&quot; and/or &quot;lom&quot;)</li>
          
<li>@OAIIdentifier: for generating the record identifier</li>
          
<li>
            <a class="externalLink" href="https://github.com/onehippo-forge/oai-pmh-provider/tree/master/demo/site/src/main/java/org/onehippo/forge/oaipmh/beans/NewsDocument.java">example newsdocument:</a>
          </li>
          
<li>
            <a class="externalLink" href="https://github.com/onehippo-forge/oai-pmh-provider/tree/master/demo/site/src/main/java/org/onehippo/forge/oaipmh/beans/TextDocument.java">example textdocument:</a>
          </li>
        </ol>
      </div>
      
<div class="section">
<h3>Make sure you have the oai:document mixin on your document<a name="Make_sure_you_have_the_oai:document_mixin_on_your_document"></a></h3>
        
<p>Either in the CND (example):</p>
        
<div class="source"><pre class="prettyprint linenums">
          

            &lt;'oaipmh.demo'='http://www.onehippo.org/oaipmh.demo/nt/1.0'&gt;
&lt;'hippo'='http://www.onehippo.org/jcr/hippo/nt/2.0'&gt;
&lt;'hippostd'='http://www.onehippo.org/jcr/hippostd/nt/2.0'&gt;
&lt;'hippostdpubwf'='http://www.onehippo.org/jcr/hippostdpubwf/nt/1.0'&gt;
&lt;'oai'='http://www.hippoecm.org/hst/nt/oai/1.0'&gt;

[oaipmh.demo:basedocument] &gt; hippo:document, hippostd:publishableSummary, hippostdpubwf:document orderable

[oaipmh.demo:textdocument] &gt; oaipmh.demo:basedocument, hippostd:relaxed

[oaipmh.demo:newsdocument] &gt; oaipmh.demo:basedocument, hippostd:relaxed, oai:document

              
        </pre></div>
        
<p>Or in your prototype (best practice):</p>
        
<div class="source"><pre class="prettyprint linenums">
          

            &lt;sv:node sv:name=&quot;hipposysedit:prototypes&quot;&gt;
    &lt;sv:property sv:name=&quot;jcr:primaryType&quot; sv:type=&quot;Name&quot;&gt;
      &lt;sv:value&gt;hipposysedit:prototypeset&lt;/sv:value&gt;
    &lt;/sv:property&gt;
    &lt;sv:node sv:name=&quot;hipposysedit:prototype&quot;&gt;
      &lt;sv:property sv:name=&quot;jcr:primaryType&quot; sv:type=&quot;Name&quot;&gt;
        &lt;sv:value&gt;oaipmh.demo:textdocument&lt;/sv:value&gt;
      &lt;/sv:property&gt;
      &lt;sv:property sv:name=&quot;jcr:mixinTypes&quot; sv:type=&quot;Name&quot;&gt;
        &lt;sv:value&gt;hippo:harddocument&lt;/sv:value&gt;
        &lt;sv:value&gt;hippotranslation:translated&lt;/sv:value&gt;
        &lt;sv:value&gt;oai:document&lt;/sv:value&gt;
      &lt;/sv:property&gt;

              
        </pre></div>
        
<p>Depending on your project, you might need to create a script which will add the mixin on all existing documents</p>
      </div>
      
<div class="section">
<h3>Add the resource to the Custom Jaxrs Plain resource Pipeline (or to custom pipeline)<a name="Add_the_resource_to_the_Custom_Jaxrs_Plain_resource_Pipeline_or_to_custom_pipeline"></a></h3>
        
<li>
          
<p>add oai-pmh.xml to META-INF.hst-assembly.overrides package of your site project. Example:</p>
          
<div class="source"><pre class="prettyprint linenums">
            
   &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd&quot;&gt;

 &lt;import resource=&quot;classpath:/org/onehippo/forge/oaipmh/provider/resource/oai-pmh.xml&quot;/&gt;



  &lt;bean id=&quot;beanPackage&quot; class=&quot;java.lang.String&quot;&gt;
    &lt;constructor-arg value=&quot;org.onehippo.demo&quot;/&gt;
  &lt;/bean&gt;

  &lt;bean id=&quot;customRestOAIPMHResourceProviders&quot; class=&quot;org.springframework.beans.factory.config.ListFactoryBean&quot;&gt;
    &lt;property name=&quot;sourceList&quot;&gt;
      &lt;list&gt;
        &lt;bean class=&quot;org.apache.cxf.jaxrs.lifecycle.SingletonResourceProvider&quot;&gt;
          &lt;constructor-arg&gt;
            &lt;bean class=&quot;org.onehippo.forge.oaipmh.provider.resource.OAIPMHResource&quot;&gt;
              &lt;property name=&quot;beansPackage&quot; value=&quot;org.onehippo.beans&quot;/&gt;
            &lt;/bean&gt;
          &lt;/constructor-arg&gt;
        &lt;/bean&gt;
      &lt;/list&gt;
    &lt;/property&gt;
  &lt;/bean&gt;

&lt;/beans&gt;
              
          </pre></div>

        </li>
      </div>
      
<div class="section">
  <h3>Configure HST mount<a name="Configure_HST_mount"></a></h3>

  <p>Configure you hst mount configuration to display the correct mount on the URL. Set the attribute hst:mountpipeline=JaxrsRestOAIPMHPipeline  e.g.
    <a class="externalLink" href="http://localhost:8080/site/pmh">http://localhost:8080/site/pmh</a>
  </p>

  <p>Automatically the oai-pmh project will set pmh mount on the hst:root mount</p>

  <p>try out the identify verb e.g.
    <a class="externalLink" href="http://localhost:8080/site/pmh/oai?verb=Identify">http://localhost:8080/site/pmh/oai?verb=Identify</a>
  </p>

  <p>You can configure metadata from the Identify by looking at the mount for the identify.path property. Which points to an Identify document</p>

</div>
      
<div class="section">
<h3>Test<a name="Test"></a></h3>
        
<li>
          <a class="externalLink" href="http://localhost:8080/site/pmh/oai?verb=Identify">Identify</a>
        </li>
        
<li>
          <a class="externalLink" href="http://localhost:8080/site/pmh/oai?verb=ListRecords&amp;metadataPrefix=oai_dc">List Records (oai_dc)</a>
        </li>
        
<li>
          <a class="externalLink" href="http://localhost:8080/site/pmh/oai?verb=ListRecords&amp;metadataPrefix=lom">List Records (lom : edurep)</a>
        </li>
        
<li>
          <a class="externalLink" href="http://localhost:8080/site/pmh/oai?verb=ListIdentifiers&amp;metadataPrefix=lom">List identifiers (lom : edurep)</a>
        </li>
        
<li>
          <a class="externalLink" href="http://localhost:8080/site/pmh/oai?verb=GetRecord&amp;identifier=9caea793-42b1-4f3e-a8e5-d58f810ce2ef&amp;metadataPrefix=lom">Get Single Record (lom : edurep)</a>
        </li>
        
<li>
          <a class="externalLink" href="http://localhost:8080/site/pmh/oai?verb=ListMetadataFormats">List Metadata formats oai_dc &amp; lom (edurep)</a>
        </li>
        
<li>
          <a class="externalLink" href="http://localhost:8080/site/pmh/oai?verb=ListSets">List Sets</a>
        </li>
      </div>
      
<div class="section">
<h3>EDUREP NLLOM<a name="EDUREP_NLLOM"></a></h3>
        
<p>Important for EDUREP!!</p>
        
<p>You should have the knowledge about the used xml formats and which elements and attributes are mandatory for edurep NLLOM</p>
        
<p>
          <a class="externalLink" href="http://wiki.surf.nl/display/nllom/Home">http://wiki.surf.nl/display/nllom/Home</a>
        </p>
        
<p>All elements and attributes are already provided in the oai-pmh project under the following package: <a class="externalLink" href="https://github.com/onehippo-forge/oai-pmh-provider/tree/master/hst/src/main/java/org/onehippo/forge/oaipmh/provider/model/oai/edurep/lom/"> package</a></p>
        
<p>Plus we also provide a helper class which should get you going: <a class="externalLink" href="https://github.com/onehippo-forge/oai-pmh-provider/tree/master/hst/src/main/java/org/onehippo/forge/oaipmh/provider/model/oai/edurep/lom/NLLom.java">NLLOM</a> in combination with
          <a class="externalLink" href="https://github.com/onehippo-forge/oai-pmh-provider/tree/master/demo/site/src/main/java/org/onehippo/forge/beans/NewsDocument.java"> newsdocument:</a></p>
        
<p>Be aware you probably need to check your own metadata configuration for mandatory elements and properties</p>
      </div>
    </div>

  

            </div>
        </div>
    </div>

    <hr/>

    <footer>
                <div class="container-fluid">
                <div class="row span12">Copyright &copy;                                                2007-2018
                                            <a href="http://www.bloomreach.com/">Hippo B.V. (http://www.bloomreach.com)</a>.
                        All Rights Reserved.            
                                        
            </div>

        
        
                </div>
    </footer>
</body>
</html>
